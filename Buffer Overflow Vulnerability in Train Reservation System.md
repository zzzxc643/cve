# Buffer Overflow Vulnerability in Train Reservation System



## supplier

[Train Ticket Reservation System In C Programming With Source Code - Source Code & Projects](https://code-projects.org/train-ticket-reservation-system-c-programming-source-code/)



##  Vulnerable File

`reservation()` function â€” specifically the `name` input using `gets()`.



##  Vulnerability Description

There is a **stack overflow vulnerability** in the `reservation()` function of the Train Reservation System project. The `name` parameter, which is defined as a `char[50]` array in a struct, is read using the unsafe `gets()` function.



###  Code Analysis

In the `reservation()` function, the following code appears:

```c
typedef struct {
    char name[50];
    int train_num;
    int num_of_seats;
} pd;


void reservation(void)
{
	char confirm;
	int i=0;
	float charges;
	pd passdetails;
	FILE *fp;
	fp=fopen("seats_reserved.txt","a");
	system("cls");
	
	printf("\nEnter Your Name:> ");
	fflush(stdin);
	gets(passdetails.name);
    ...
}

```



## POC



input username and password

![image-20250416160158931](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160158931.png)



 Choose "Reserve a Ticket"

![image-20250416160213987](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160213987.png)



enter payload to cause the stack overflow to crash

```
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
```

then,just type in any number



![image-20250416160544959](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160544959.png)



choose 1001

![image-20250416160657605](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160657605.png)

enter y after 'Confirm Ticket (y/n):>'

![image-20250416160725760](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160725760.png)



### result

we can see EXCEPTION_ACCESS_VIOLATION.

![image-20250416160839202](https://raw.githubusercontent.com/zzzxc643/images/main/image/image-20250416160839202.png)